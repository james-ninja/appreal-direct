/*!
 * WooCommerce Bulk Variations 1.2.1
 * Copyright 2021 Barn2 Plugins
 */
(function(_,i,t,p){"use strict";_(function(){function n(){var l=[],d=[],c=[];_(".wcbvp_quantity").each(function(t){var a=_(this).data("table_id"),e=parseInt(_(this).val()),i=parseFloat(_(this).data("price")),r=parseInt(_(this).data("product_id"));if(0<=e){var n=e*i,o=0,i=0;for(l[a]!==p&&(o+=l[a]),d[a]!==p&&(i+=d[a]),l[a]=o+e,d[a]=i+n,t=0;t<e;t++)c[a]==p&&(c[a]=[]),c[a].push(r)}}),_(".wcbvp_total_price").each(function(t){var a=b2_currency_options.decimals,e=b2_currency_options.d_separator,i=b2_currency_options.t_separator;a==p&&(a=2),e==p&&(e="."),i==p&&(i="");var r=_(this).data("table_id");d[r]!==p&&(a=function(t,a,e){var i=(t=(t+="").split("."))[0],t=1<t.length?a+t[1]:"";if(3<i.length&&e)for(var r=Math.floor(i.length/3),n=0;n<r;n++){var o=i.length-n*e.length-3*(n+1);if(o<=0)break;i=[i.slice(0,o),i.slice(o)].join(e)}return i+t}(a=d[r].toFixed(a),e,i),_(this).text(a))}),_(".wcbvp_total_quantity").each(function(t){var a=_(this).data("table_id");l[a]!==p&&(_(this).text(l[a]),0<l[a]&&c[a]!==p?(_("#wcbvp_wrapper_"+a+" .single_add_to_cart_button").removeClass("disabled"),_("#wcbvp_wrapper_"+a+" .single_add_to_cart_button").removeClass("wc-variation-selection-needed"),_("#wcbvp_wrapper_"+a+" .single_add_to_cart_button").prop("disabled",!1),_("#wcbvp_wrapper_"+a+' [name="multiple-add-to-cart"]').val(c[a].toString())):(_("#wcbvp_wrapper_"+a+".single_add_to_cart_button").addClass("disabled"),_("#wcbvp_wrapper_"+a+".single_add_to_cart_button").addClass("wc-variation-selection-needed"),_("#wcbvp_wrapper_"+a+".single_add_to_cart_button").prop("disabled",!0)))})}_(t.body).on("input",".wcbvp_quantity",function(t){var a=t.currentTarget,e=_(a),i=e.attr("max");i=i&&i.toString();i&&!isNaN(parseFloat(i))&&isFinite(i)&&(i=parseInt(i),e.val()>i&&(t.preventDefault(),e.val(i)));var r=e.data("individual"),t=e.data("table_id"),i=e.val();r&&0<i&&(_('.wcbvp_quantity[data-table_id="'+t+'"]').not(a).val(0),1<i&&e.val(1));n()}),n(),_(t.body).on("click",".wc-bulk-variations-table .woocommerce-product-gallery__image a",function(t){if("undefined"==typeof PhotoSwipe||"undefined"==typeof PhotoSwipeUI_Default)return!0;t.preventDefault();var a=_(".pswp")[0],t=_(t.target).closest(".woocommerce-product-gallery__image"),e=[];a.classList.add("wbv-gallery"),0<t.length&&t.each(function(t,a){a=_(a).find("img"),a={src:a.attr("data-large_image"),w:a.attr("data-large_image_width"),h:a.attr("data-large_image_height"),title:a.attr("data-caption")&&a.attr("data-caption").length?a.attr("data-caption"):a.attr("title")};e.push(a)}),(a=new PhotoSwipe(a,PhotoSwipeUI_Default,e,{index:0,shareEl:!1,closeOnScroll:!1,history:!1,hideAnimationDuration:0,showAnimationDuration:0})).init(),a.listen("close",function(){i.dontCloseQVP=!0})})})})(jQuery,window,document);